{% extends "_layouts/generic-page-layout.twig" %}
{% block content %}
{# If there were any validation errors, a `user` variable will be passed to the
   template, which contains the posted values and validation errors. If that’s not
   set, we’ll default to the current user. #}
   {% set user = user ?? currentUser %}
{# Require that a user is logged in to view this form. #}
{% requireLogin %}

{% set forceVerify = null %}

{% if user.profileComplete == "no" or user.verifiedMembership == "no" %}
{% set forceVerify = true %}
{% endif %}

{% if forceVerify == true %}{% redirect "profile-complete" %}{% endif %}

{% macro errorList(errors) %}
  {% if errors %}
    {{ ul(errors, {class: 'errors'}) }}
  {% endif %}
{% endmacro %}


{# 
{% if user.hasErrors() %}
  <p>Unable to save your profile.</p>
{% endif %} #}

<main>
    <section class="pt-5 pb-5">
      <div class="container">
        test: {{forceVerify}}
        <!-- User info -->
        <div class="row align-items-center">
          <div class="col-xl-12 col-lg-12 col-md-12 col-12">
            <!-- Bg -->
            <div class="rounded-top" style="background: url(../assets/images/background/profile-bg.jpg) no-repeat; background-size: cover; height: 100px"></div>
            <div class="card px-4 pt-2 pb-4 shadow-sm rounded-top-0 rounded-bottom-0 rounded-bottom-md-2">
              <div class="d-flex align-items-end justify-content-between">
                <div class="d-flex align-items-center">
                  <div class="me-2 position-relative d-flex justify-content-end align-items-end mt-n5">
                    <img src="{{user.photo.url('profileSmall')}}" class="avatar-xl rounded-circle border border-4 border-white" alt="avatar">
                  </div>
                  <div class="lh-1">
                    <h2 class="mb-0">
                      {{user.fullName}}
                      <a href="#" data-bs-toggle="tooltip" data-placement="top" aria-label="Beginner" data-bs-original-title="Beginner">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <rect x="3" y="8" width="2" height="6" rx="1" fill="#754FFE"></rect>
                          <rect x="7" y="5" width="2" height="9" rx="1" fill="#DBD8E9"></rect>
                          <rect x="11" y="2" width="2" height="12" rx="1" fill="#DBD8E9"></rect>
                        </svg>
                      </a>
                    </h2>
                    <p class="mb-0 d-block"></p>
                  </div>
                </div>
                <div>
                  <a href="profile-edit.html" class="btn btn-primary btn-sm d-none d-md-block">Account Setting</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Content -->
        <div class="row mt-0 mt-md-4">
          <div class="col-lg-3 col-md-4 col-12">
            <!-- Side navbar -->
            <nav class="navbar navbar-expand-md shadow-sm mb-4 mb-lg-0 sidenav">
              <!-- Menu -->
              <a class="d-xl-none d-lg-none d-md-none text-inherit fw-bold" href="#">Menu</a>
              <!-- Button -->
              <button class="navbar-toggler d-md-none icon-shape icon-sm rounded bg-primary text-light" type="button" data-bs-toggle="collapse" data-bs-target="#sidenav" aria-controls="sidenav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="fe fe-menu"></span>
              </button>
              <!-- Collapse navbar -->
              <div class="collapse navbar-collapse" id="sidenav">
                <div class="navbar-nav flex-column">
                  <span class="d-none navbar-header">Subscription</span>
                  <!-- List -->
                  <ul class="d-none list-unstyled ms-n2 mb-4">
                    <!-- Nav item -->
                    <li class="nav-item">
                      <a class="nav-link" href="student-subscriptions.html">
                        <i class="fe fe-calendar nav-icon"></i>
                        My Subscriptions
                      </a>
                    </li>
                    <!-- Nav item -->
                    <li class="nav-item">
                      <a class="nav-link" href="billing-info.html">
                        <i class="fe fe-credit-card nav-icon"></i>
                        Billing Info
                      </a>
                    </li>
                    <!-- Nav item -->
                    <li class="nav-item">
                      <a class="nav-link" href="payment-method.html">
                        <i class="fe fe-credit-card nav-icon"></i>
                        Payment
                      </a>
                    </li>
                    <!-- Nav item -->
                    <li class="nav-item">
                      <a class="nav-link" href="invoice.html">
                        <i class="fe fe-clipboard nav-icon"></i>
                        Invoice
                      </a>
                    </li>
                    <!-- Nav item -->
                    <li class="nav-item">
                      <a class="nav-link" href="student-quiz.html">
                        <i class="fe fe-help-circle nav-icon"></i>
                        My Quiz Attempt
                      </a>
                    </li>
                  </ul>
                  <span class="navbar-header">Account Settings</span>
                  <!-- List -->
                  <ul class="list-unstyled ms-n2 mb-0">
                    <!-- Nav item -->
                    <li class="nav-item ">
                      <a class="nav-link" href="profile-edit.html">
                        <i class="fe fe-user nav-icon"></i>
                        View profile
                      </a>
                    </li>
                    <!-- Nav item -->
                    <li class="nav-item ">
                      <a class="nav-link" href="profile-edit.html">
                        <i class="fe fe-settings nav-icon"></i>
                        Edit Profile
                      </a>
                    </li>
                    <!-- Nav item -->
                    <li class="nav-item">
                      <a class="nav-link" href="{{ alias('@baseUrl') }}/logout">
                        <i class="fe fe-power nav-icon"></i>
                        Sign Out
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </nav>
          </div>
          <div class="col-lg-9 col-md-8 col-12">
            <!-- Card -->
            <div class="card">
              <!-- Card header -->
              <div class="card-header">
                <h3 class="mb-0">Edit profile details</h3>
                <p class="mb-0">You have full control to manage your own account setting.</p>
              </div>
              <!-- Card body -->
              <div class="card-body">
                <div class="d-lg-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center mb-4 mb-lg-0">
                    <img src="{{user.photo.url('profileSmall')}}" id="img-uploaded" class="avatar-xl rounded-circle" alt="avatar">
                    <div class="ms-3">
                      <h4 class="mb-0">Your photo</h4>
                      <p class="mb-0">PNG or JPG square format best, no bigger than 800px wide and tall.</p>
                    </div>
                  </div>
                  <div>
                    {% if user.photo %}
                    <div class="mb-3 col-12 col-md-6">
                         <label for="delete-photo">
                        {{ input('checkbox', 'deletePhoto', '1', {
                          id: 'delete-photo',
                          class: 'form-check-input border'
                        }) }}
                        Delete photo
                      </label>
                    </div>
  {% endif %}
                <div class="mb-3 col-12 col-md-6">
                    <label for="photo">Upload a new photo</label>
                    {{ input('file', 'photo', null, {
                      id: 'photo',
                      accept: 'image/png,image/jpeg',
                      class: ''
                    }) }}
                </div>
                    
                  </div>
                </div>
                <hr class="my-5">
                <div>
                  <h4 class="mb-0">Personal Details</h4>
                  <p class="mb-4">Edit your personal information and address.</p>
                  <!-- Form -->
                  <form class="row gx-3 needs-validation" novalidate="">
                    <!-- First name -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditFname">First Name</label>
                      <input type="text" id="profileEditFname" name="profileEditFname" class="form-control" placeholder="First Name" required="">
                      <div class="invalid-feedback">Please enter first name.</div>
                    </div>
                    <!-- Last name -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditLname">Last Name</label>
                      <input type="text" id="profileEditLname" name="profileEditLname" class="form-control" placeholder="Last Name" required="">
                      <div class="invalid-feedback">Please enter last name.</div>
                    </div>
                    <!-- Phone -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditPhone">Phone</label>
                      <input type="text" id="profileEditPhone" name="profileEditPhone" class="form-control" placeholder="Phone" required="">
                      <div class="invalid-feedback">Please enter phone number.</div>
                    </div>
                    <!-- Birthday -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditBirth">Birthday</label>
                      <input class="form-control flatpickr flatpickr-input" type="text" placeholder="Birth of Date" id="profileEditBirth" name="profileEditBirth" readonly="readonly">
                      <div class="invalid-feedback">Please choose a date.</div>
                    </div>
                    <!-- Address -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditAddress1">Address Line 1</label>
                      <input type="text" id="profileEditAddress1" name="profileEditAddress1" class="form-control" placeholder="Address" required="">
                      <div class="invalid-feedback">Please enter address.</div>
                    </div>
                    <!-- Address -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditAddress2">Address Line 2</label>
                      <input type="text" id="profileEditAddress2" name="profileEditAddress2" class="form-control" placeholder="Address" required="">
                      <div class="invalid-feedback">Please enter address.</div>
                    </div>
                    <!-- State -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="profileEditState">State</label>
                      <div class="choices" data-type="select-one" tabindex="0" role="listbox" aria-haspopup="true" aria-expanded="false"><div class="choices__inner"><select class="form-select choices__input" data-choices="" id="profileEditState" name="profileEditState" required="" hidden="" tabindex="-1" data-choice="active"><option value="" data-custom-properties="[object Object]">Select State</option></select><div class="choices__list choices__list--single"><div class="choices__item choices__placeholder choices__item--selectable" data-item="" data-id="1" data-value="" data-custom-properties="[object Object]" aria-selected="true">Select State</div></div></div><div class="choices__list choices__list--dropdown" aria-expanded="false"><div class="choices__list" role="listbox"><div id="choices--profileEditState-item-choice-4" class="choices__item choices__item--choice is-selected choices__placeholder choices__item--selectable is-highlighted" role="option" data-choice="" data-id="4" data-value="" data-select-text="" data-choice-selectable="" aria-selected="true">Select State</div><div id="choices--profileEditState-item-choice-1" class="choices__item choices__item--choice choices__item--selectable" role="option" data-choice="" data-id="1" data-value="1" data-select-text="" data-choice-selectable="">Gujarat</div><div id="choices--profileEditState-item-choice-2" class="choices__item choices__item--choice choices__item--selectable" role="option" data-choice="" data-id="2" data-value="3" data-select-text="" data-choice-selectable="">Maharashtra</div><div id="choices--profileEditState-item-choice-3" class="choices__item choices__item--choice choices__item--selectable" role="option" data-choice="" data-id="3" data-value="2" data-select-text="" data-choice-selectable="">Rajasthan</div></div></div></div>
                      <div class="invalid-feedback">Please choose state.</div>
                    </div>
                    <!-- Country -->
                    <div class="mb-3 col-12 col-md-6">
                      <label class="form-label" for="editCountry">Country</label>
                      <div class="choices" data-type="select-one" tabindex="0" role="listbox" aria-haspopup="true" aria-expanded="false"><div class="choices__inner"><select class="form-select choices__input" data-choices="" id="editCountry" required="" hidden="" tabindex="-1" data-choice="active"><option value="" data-custom-properties="[object Object]">Select Country</option></select><div class="choices__list choices__list--single"><div class="choices__item choices__placeholder choices__item--selectable" data-item="" data-id="1" data-value="" data-custom-properties="[object Object]" aria-selected="true">Select Country</div></div></div><div class="choices__list choices__list--dropdown" aria-expanded="false"><div class="choices__list" role="listbox"><div id="choices--editCountry-item-choice-2" class="choices__item choices__item--choice is-selected choices__placeholder choices__item--selectable is-highlighted" role="option" data-choice="" data-id="2" data-value="" data-select-text="" data-choice-selectable="" aria-selected="true">Select Country</div><div id="choices--editCountry-item-choice-1" class="choices__item choices__item--choice choices__item--selectable" role="option" data-choice="" data-id="1" data-value="1" data-select-text="" data-choice-selectable="">India</div><div id="choices--editCountry-item-choice-3" class="choices__item choices__item--choice choices__item--selectable" role="option" data-choice="" data-id="3" data-value="2" data-select-text="" data-choice-selectable="">UK</div><div id="choices--editCountry-item-choice-4" class="choices__item choices__item--choice choices__item--selectable" role="option" data-choice="" data-id="4" data-value="3" data-select-text="" data-choice-selectable="">USA</div></div></div></div>
                      <div class="invalid-feedback">Please choose country.</div>
                    </div>
                    <div class="col-12">
                      <!-- Button -->
                      <button class="btn btn-primary" type="submit">Update Profile</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
{% endblock content %}